# =========================================================
#      Install EXE Directly from File Share (No Mapping)
# =========================================================

# üëâ CHANGE THIS ‚Äî UNC path to the installer file
$InstallerPath = "\\YOURFILESERVER\Applications\YourAppFolder\YourAppSetup.exe"

# üëâ CHANGE THIS ‚Äî Silent install switch for your app
$SilentArgs = "/S"

# ------------------- üîê OPTIONAL CREDENTIALS -------------------
# Only needed if the VM computer account does NOT have access
$UseCredentials = $true   # Change to $false if not needed

# üëâ CHANGE if credentials are required
$Username = "DOMAIN\svc_account"
$Password = "P@ssw0rd!"

Write-Host "===== Starting Application Installation ====="

if ($UseCredentials) {
    Write-Host "Connecting to file share with credentials..."

    $SecurePassword = ConvertTo-SecureString $Password -AsPlainText -Force
    $Cred = New-Object System.Management.Automation.PSCredential ($Username, $SecurePassword)

    New-PSDrive -Name "TempShare" -PSProvider FileSystem -Root (Split-Path $InstallerPath) -Credential $Cred -ErrorAction Stop

    $MappedInstaller = "TempShare:\" + (Split-Path $InstallerPath -Leaf)

    Write-Host "Running installer from mapped UNC path..."
    Start-Process -FilePath $MappedInstaller -ArgumentList $SilentArgs -Wait -NoNewWindow

    Remove-PSDrive -Name "TempShare" -Force
}
else {
    Write-Host "Running installer directly from UNC path..."
    Start-Process -FilePath $InstallerPath -ArgumentList $SilentArgs -Wait -NoNewWindow
}

Write-Host "===== Installation Completed ====="
